#include "T100VHDTest.h"

#include "windows.h"

#include "T100MSvhd.h"


T100VHDTest::T100VHDTest()
{
    //ctor
}

T100VHDTest::~T100VHDTest()
{
    //dtor
}


T100BOOL T100VHDTest::checksum()
{
    T100MSvhd       vhd;

    vhd.create();

    return T100FALSE;

    T100BYTE        data[512]   = {
        0x63,   0x6f,   0x6e,   0x65,   0x63,   0x74,   0x69,   0x78,
        0x00,   0x00,   0x00,   0x02,   0x00,   0x01,   0x00,   0x00,
        0xff,   0xff,   0xff,   0xff,   0xff,   0xff,   0xff,   0xff,
        0x2d,   0x62,   0x50,   0x44,   0x77,   0x69,   0x6e,   0x20,
        0x00,   0x0a,   0x00,   0x00,   0x57,   0x69,   0x32,   0x6b,
        0x00,   0x00,   0x00,   0x00,   0x40,   0x00,   0x00,   0x00,
        0x00,   0x00,   0x00,   0x00,   0x40,   0x00,   0x00,   0x00,
        0x08,   0x20,   0x10,   0x3f,   0x00,   0x00,   0x00,   0x02,
        0xff,   0xff,   0xe9,   0x29,   0x75,   0x50,   0x5d,   0x21,
        0x36,   0xf9,   0xfd,   0x43,   0xa1,   0x11,   0x63,   0x0b,
        0x20,   0xbf,   0x68,   0x74
    };
    memset((void*)(data+84), 0, 428);

    T100BYTE*       index           = T100NULL;
    T100INT32       total           = 0;
    T100INT32       item;

    index   = data;

    for(int i=0;i<16;i++){
        item    = *index;
        total   += ntohl(item);

        index   += 4;
    }

    index   += 4;
    for(int i=0;i<5;i++){
        item    = *index;
        total   += ntohl(item);

        index   += 4;
    }

    T100INT32   result;

    //totol = 5846

    result  = ntohl(total);

    memcpy(data + 508, (void*)&result, 4);
}
